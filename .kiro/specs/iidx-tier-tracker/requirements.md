# 要求仕様書

## 概要
本ドキュメントは「beatmania IIDX 難易度表準拠クリアランプ管理Webアプリ」の要求を定義します。ユーザーはIIDXの楽曲リストを閲覧し、自身のクリア状況を記録・追跡できます。

## 要求一覧

### 1. ユーザー認証
**目的:** ユーザーとして、自分のクリアデータを安全に管理するため、アカウントを作成し、ログインしたい。Googleアカウントでのログインが望ましい。

#### 受け入れ基準
1.  **（ユビキタス）** システムは、ユーザーアカウント情報を安全に保存しなければならない。
2.  **（イベント駆動）** ユーザーが有効な認証情報でログインフォームを送信したとき、システムはユーザーを認証し、セッションを開始しなければならない。
3.  **（イベント駆動）** ユーザーが無効な認証情報を入力した場合、システムはエラーメッセージを表示しなければならない。
4.  **（イベント駆動）** ユーザーがログアウトを選択したとき、システムは現在のセッションを終了させ、ログインページにリダイレクトしなければならない。

### 2. 難易度表の表示
**目的:** ユーザーとして、楽曲のクリア状況を確認・更新するため、公式の難易度表（例：SP☆10）を閲覧したい。公式のAPIなどが無いため、Textage(https://textage.cc/score/index.html?a011B000)などからスクレイピングをする補助ツールも作成したい。IIDXの更新は不定期であるため、手動実行する手段があればよい。

#### 受け入れ基準
1.  **（ユビキタス）** システムは、beatmania IIDXのバージョン、レベル、譜面（NORMAL, HYPER, ANOTHER）に基づいた楽曲データを表示しなければならない。
2.  **（イベント駆動）** ユーザーが特定の難易度レベル（例：☆12）を選択したとき、システムはそのレベルに属する楽曲リストを難易度表形式で表示しなければならない。
3.  **（状態駆動）** 楽曲リストが表示されている間、システムは各楽曲に対してユーザーの現在のクリアランプ（NO PLAY, FAILED, ASSIST CLEAR, EASY CLEAR, CLEAR, HARD, EX-HARD, FULLCOMBO）を表示しなければならない。
4.  **（ユビキタス）** システムは、楽曲名や難易度でリストをフィルタリングする機能を提供しなければならない。

### 3. クリアランプ管理
**目的:** ユーザーとして、自分のプレイ成果を記録するため、各楽曲のクリアランプ状態を更新したい。

#### 受け入れ基準
1.  **（イベント駆動）** ユーザーが特定の楽曲のクリアランプアイコンをクリックしたとき、システムはランプ状態を更新するための選択肢（ドロップダウンメニューなど）を提示しなければならない。
2.  **（イベント駆動）** ユーザーが新しいランプ状態を選択して保存したとき、システムはその変更をデータベースに記録し、即座に難易度表の表示に反映させなければならない。
3.  **（ユビキタス）** システムは、クリアランプの変更履歴を追跡しなければならない。
4.　**(イベント駆動)** IST(ex:https://score.iidx.app/users/6188-5303)にユーザーが登録することで、自動的にランプを管理できる機能が必要。IIDXのユーザーID(ex:6188-5303)を入力することで、userがIST連携ボタンを押すと自動でデータを取得できる機能がなければならない。ISTのクリア状況よりも、本Webアプリが保持しているクリア状況を優先的に保持するものとする。

### 4. データ永続化
**目的:** システムとして、ユーザーデータを確実に保持するため、クリアランプ情報をデータベースに保存したい。

#### 受け入れ基準
1.  **（ユビキタス）** システムは、各ユーザーのクリアランプ情報をリレーショナルデータベースまたはNoSQLデータベースに保存しなければならない。
2.  **（ユビキタス）** データベースへの書き込みおよび読み込み操作は、アトミックかつ一貫性が保たれていなければならない。

### 5. 統計機能
**目的:** ユーザーとして、自分の成長を確認するため、クリア状況に基づいた統計情報を閲覧したい。GitHubのコントリビューション・カレンダーのような機能を追加し、どの程度遊んだか？を可視化したい。

#### 受け入れ基準
1.  **（ユビキタス）** システムは、難易度レベルごとにクリア済みの楽曲数を集計し、グラフで表示しなければならない。
2.  **（イベント駆動）** ユーザーが統計ページにアクセスしたとき、システムは最新のクリア状況に基づいたサマリー（例：未クリア曲数、HARDクリア済曲数）を表示しなければならない。